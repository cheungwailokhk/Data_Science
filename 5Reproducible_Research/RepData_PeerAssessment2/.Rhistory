View(health_df3)
View(health_df2)
View(health_df2)
View(health_df3)
View(health_df2)
View(health_df3)
View(health_df2)
View(health_df3)
View(health_df2)
View(health_df2)
ggplot(health_df2,
#map columns to aesthetics:
aes(x = EVENT, y = VALUE,
#important to use a factor for discrete values:
color = factor(VARIABLE),
fill = factor(VARIABLE))) +
geom_col()
ggplot(health_df2,
#map columns to aesthetics:
aes(x = EVENT, y = VALUE) )+
geom_line()
str(health_df2)
str(df2)
View(df2)
stems <- df2$EVENT
View(stems)
df2$EVENT <- as.character(steams)
df2$EVENT <- as.character(stems)
View(df2)
str(df2)
health_df <- df2 %>%
group_by(EVENT) %>%
summarise(FATALITIES = sum(FATALITIES), INJURIES = sum(INJURIES)) %>%
arrange(desc(FATALITIES+INJURIES))
str(health_df2)
df2$EVENT <- as.character(stems)
str(df2)
df2
head(df2)
health_df <- df2 %>%
group_by(EVENT) %>%
summarise(FATALITIES = sum(FATALITIES), INJURIES = sum(INJURIES)) %>%
arrange(desc(FATALITIES+INJURIES))
str(health_df)
health_df2 <- health_df %>%
gather(VARIABLE, VALUE, FATALITIES, INJURIES)
str(health_df2)
View(health_df2)
View(health_df3)
View(health_df2)
rm(health_df3)
View(health_df2)
View(health_df2)
health_df2 <- health_df %>%
gather(TOLLS, VALUE, FATALITIES, INJURIES)
ggplot(df, aes(x = EVENT,
y  = VALUE,
fill = factor(TOLLS),
color = factor(TOLLS))) +
geom_bar()
View(health_df2)
ggplot(health_df2, aes(x = EVENT,
y  = VALUE,
fill = factor(TOLLS),
color = factor(TOLLS))) +
geom_bar()
ggplot(health_df2, aes(x = EVENT,
y  = VALUE,
fill = factor(TOLLS),
color = factor(TOLLS))) +
geom_bar(stat = "identity")
health_df2 <- head(health_df, 10) %>%
gather(TOLLS, VALUE, FATALITIES, INJURIES)
ggplot(health_df2, aes(x = EVENT,
y  = VALUE,
fill = factor(TOLLS),
color = factor(TOLLS))) +
geom_bar(stat = "identity")
View(health_df2)
View(health_df)
## order by frequency, the most frequent bar coming first.
ggplot(health_df2, aes(x = reorder(EVENT, -VALUE),
y  = VALUE,
fill = factor(TOLLS),
color = factor(TOLLS))) +
geom_bar(stat = "identity")
health_df2 <- head(health_df, 10) %>%
gather(Impact, Numbers, FATALITIES, INJURIES)
## order by frequency, the most frequent bar coming first.
ggplot(health_df2, aes(x = reorder(EVENT, -Numbers),
y  = Numbers,
fill = factor(Impact),
color = factor(Impact))) +
geom_bar(stat = "identity")
ggplot(health_df2, aes(x = reorder(EVENT, -Numbers),
y  = Numbers,
fill = factor(Impact),
color = factor(Impact))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
ggplot(health_df2, aes(x = reorder(EVENT, -Numbers),
y  = Numbers,
fill = factor(Impact),
color = factor(Impact))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
ggplot(health_df2, aes(x = reorder(EVENT, -Numbers),
y  = Numbers,
fill = factor(Impact),
color = factor(Impact))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
axis.text.x = element_text(angle = 70, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
ggplot(health_df2, aes(x = reorder(EVENT, -Numbers),
y  = Numbers,
fill = factor(Impact),
color = factor(Impact))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
View(health_df)
View(df2)
View(health_df)
rm(stems)
health_df2 <- head(health_df) %>%
gather(Impact, Numbers, FATALITIES, INJURIES)
health_df <- df2 %>%
group_by(EVENT) %>%
summarise(FATALITIES = sum(FATALITIES), INJURIES = sum(INJURIES)) %>%
arrange(desc(FATALITIES+INJURIES))
health_df2 <- head(health_df) %>%
gather(Impact, Numbers, FATALITIES, INJURIES)
View(health_df2)
View(health_df)
View(health_df)
health_df2 <- health_df %>%
gather(Impact, Numbers, FATALITIES, INJURIES)
View(health_df2)
View(health_df)
health_df <- df2 %>%
group_by(EVENT) %>%
summarise(FATALITIES = sum(FATALITIES), INJURIES = sum(INJURIES)) %>%
arrange(desc(FATALITIES+INJURIES))
View(health_df)
health_df[1:]
head(health_df, -10)
head(health_df, 10)
nrow(health_df)
tail(health_df, nrow(health_df) - 10)
View(health_df)
?aggreate
?aggregate
View(health_df)
other_df <- aggregate(FATALITIES ~ INJURIES, data=tail(health_df, nrow(health_df) - 10) , FUN=sum)
View(other_df)
other_df <- aggregate(EVENT ~ INJURIES, data=tail(health_df, nrow(health_df) - 10) , FUN=sum)
other_df <- aggregate(INJURIES ~ EVENT, data=tail(health_df, nrow(health_df) - 10) , FUN=sum)
View(other_df)
other_df <- aggregate(.~EVENT, data=tail(health_df, nrow(health_df) - 10) , FUN=sum)
View(other_df)
View(other_df)
View(other_df)
other_df <- tail(health_df, nrow(health_df) - 10)
View(other_df)
View(other_df)
health_df <- head(health_df, 10) %>%
rbind( data.frame("Other",sum(other_df$FATALITIES), sum(other_df$INJURIES)))
?data.frame
health_df <- head(health_df, 10) %>%
rbind( data.frame(Event = "Other", FATALITIES = sum(other_df$FATALITIES), INJURIES = sum(other_df$INJURIES)))
View(health_df)
health_df <- head(health_df, 10)
rbind(health_df, data.frame(Event = "Other", FATALITIES = sum(other_df$FATALITIES), INJURIES = sum(other_df$INJURIES)))
data.frame(Event = "Other", FATALITIES = sum(other_df$FATALITIES), INJURIES = sum(other_df$INJURIES))
x = data.frame(Event = "Other", FATALITIES = sum(other_df$FATALITIES), INJURIES = sum(other_df$INJURIES))
View(x)
health_df <- head(health_df, 10) %>%
rbind(data.frame(EVENT = "Other", FATALITIES = sum(other_df$FATALITIES), INJURIES = sum(other_df$INJURIES)))
View(health_df)
health_df <- df2 %>%
group_by(EVENT) %>%
summarise(FATALITIES = sum(FATALITIES), INJURIES = sum(INJURIES)) %>%
arrange(desc(FATALITIES+INJURIES))
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(health_df, nrow(health_df) - 10) %>%
summarize(Other = sum)
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(health_df, nrow(health_df) - 10)
health_df <- head(health_df, 10) %>%
rbind(data.frame(EVENT = "other", FATALITIES = sum(other_df$FATALITIES), INJURIES = sum(other_df$INJURIES)))
rm(other_df)
rm(x)
health_df2 <- health_df %>%
gather(Impact, Numbers, FATALITIES, INJURIES)
## order by frequency, the most frequent bar coming first.
ggplot(health_df2, aes(x = reorder(EVENT, -Numbers),
y  = Numbers,
fill = factor(Impact),
color = factor(Impact))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
health_df <- df2 %>%
group_by(EVENT) %>%
summarise(FATALITIES = sum(FATALITIES), INJURIES = sum(INJURIES)) %>%
arrange(desc(FATALITIES+INJURIES))
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(health_df, nrow(health_df) - 10)
health_df <- head(health_df, 10) %>%
rbind(data.frame(EVENT = "other", FATALITIES = sum(other_df$FATALITIES), INJURIES = sum(other_df$INJURIES)))
rm(other_df)
View(health_df)
health_df <- health_df %>%
gather(Impact, Numbers, FATALITIES, INJURIES)
## order by frequency, the most frequent bar coming first.
ggplot(health_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
health_df <- health_df %>%
gather(RESULT, NUMBERS, FATALITIES, INJURIES)
health_df <- health_df %>%
gather(RESULT, NUMBERS, FATALITIES, INJURIES)
health_df <- health_df %>%
gather(RESULT, NUMBERS, FATALITIES, INJURIES)
health_df <- df2 %>%
group_by(EVENT) %>%
summarise(FATALITIES = sum(FATALITIES), INJURIES = sum(INJURIES)) %>%
arrange(desc(FATALITIES+INJURIES))
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(health_df, nrow(health_df) - 10)
health_df <- head(health_df, 10) %>%
rbind(data.frame(EVENT = "other", FATALITIES = sum(other_df$FATALITIES), INJURIES = sum(other_df$INJURIES)))
rm(other_df)
View(health_df)
health_df <- health_df %>%
gather(RESULT, NUMBERS, FATALITIES, INJURIES)
View(health_df)
## order by frequency, the most frequent bar coming first.
ggplot(health_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
rm(health_df2)
rm(l)
ggplot(health_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set2")
ggplot(health_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Number of casualties") +
ggtitle("The most harmful event types to population health") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set3")
econ_df <- df2 %>%
group_by(EVENT) %>%
summarise(TOTALPROP = sum(TOTALPROP), TOTALCROP = sum(TOTALCROP)) %>%
arrange(desc(TOTALPROP+TOTALCROP))
View(health_df)
View(econ_df)
other_df <- tail(econ_df, nrow(econ_df) - 10)
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(econ_df, nrow(econ_df) - 10)
econ_df <- head(econ_df, 10) %>%
rbind(data.frame(EVENT = "other", TOTALCROP = sum(other_df$TOTALCROP), TOTALPROP = sum(other_df$TOTALPROP)))
rm(other_df)
View(econ_df)
econ_df <- econ_df %>%
gather(RESULT, NUMBERS, TOTALPROP, TOTALCROP)
View(econ_df)
econ_df <- df2 %>%
group_by(EVENT) %>%
summarise(TOTALPROP = sum(TOTALPROP), TOTALCROP = sum(TOTALCROP)) %>%
arrange(desc(TOTALPROP+TOTALCROP))
View(econ_df)
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(econ_df, nrow(econ_df) - 10)
econ_df <- head(econ_df, 10) %>%
rbind(data.frame(EVENT = "other", TOTALCROP = sum(other_df$TOTALCROP), TOTALPROP = sum(other_df$TOTALPROP)))
rm(other_df)
# Gather dataframe for the plot
econ_df <- econ_df %>%
gather(RESULT, NUMBERS, TOTALPROP, TOTALCROP)
View(econ_df)
econ_df <- df2 %>%
group_by(EVENT) %>%
summarise(TOTALPROP = sum(TOTALPROP), TOTALCROP = sum(TOTALCROP)) %>%
arrange(desc(TOTALPROP+TOTALCROP))
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(econ_df, nrow(econ_df) - 10)
econ_df <- head(econ_df, 10) %>%
rbind(data.frame(EVENT = "other", TOTALCROP = sum(other_df$TOTALCROP), TOTALPROP = sum(other_df$TOTALPROP)))
rm(other_df)
# Gather dataframe for the plot
econ_df <- econ_df %>%
gather(RESULT, NUMBERS, TOTALPROP, TOTALCROP)
## order by frequency, the most frequent bar coming first.
ggplot(health_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Monetary loss") +
ggtitle("The events have the greatest economic consequences ") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
econ_df <- df2 %>%
group_by(EVENT) %>%
summarise(TOTALPROP = sum(TOTALPROP), TOTALCROP = sum(TOTALCROP)) %>%
arrange(desc(TOTALPROP+TOTALCROP))
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(econ_df, nrow(econ_df) - 10)
econ_df <- head(econ_df, 10) %>%
rbind(data.frame(EVENT = "other", TOTALCROP = sum(other_df$TOTALCROP), TOTALPROP = sum(other_df$TOTALPROP)))
rm(other_df)
# Gather dataframe for the plot
econ_df <- econ_df %>%
gather(RESULT, NUMBERS, TOTALPROP, TOTALCROP)
## order by frequency, the most frequent bar coming first.
ggplot(econ_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Monetary loss") +
ggtitle("The events have the greatest economic consequences ") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
ggplot(econ_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS / 10^5,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Monetary loss") +
ggtitle("The events have the greatest economic consequences ") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
ggplot(econ_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS / 10^6,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Monetary loss") +
ggtitle("The events have the greatest economic consequences ") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
econ_df <- df2 %>%
group_by(EVENT) %>%
summarise(TOTALPROP = sum(TOTALPROP), TOTALCROP = sum(TOTALCROP)) %>%
arrange(desc(TOTALPROP+TOTALCROP))
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(econ_df, nrow(econ_df) - 10)
econ_df <- head(econ_df, 10) %>%
rbind(data.frame(EVENT = "other", CropLoss = sum(other_df$TOTALCROP), PropertyLoss = sum(other_df$TOTALPROP)))
View(econ_df)
names(econ_df) = c("Event", "PropertyLoss", "CropLoss")
econ_df <- df2 %>%
group_by(EVENT) %>%
summarise(PropertyLoss = sum(PropertyLoss), CropLoss = sum(CropLoss)) %>%
arrange(desc(PropertyLoss+CropLoss))
df2$CropLoss <- df2$CROPDMG * df2$CROPDMGEXP
df2$PropertyLoss <- df2$PROPDMG * df2$PROPDMGEXP
econ_df <- df2 %>%
group_by(EVENT) %>%
summarise(PropertyLoss = sum(PropertyLoss), CropLoss = sum(CropLoss)) %>%
arrange(desc(PropertyLoss+CropLoss))
# Reduce data to only top 10 harmful events,and summarize the rest into "Other"
other_df <- tail(econ_df, nrow(econ_df) - 10)
econ_df <- head(econ_df, 10) %>%
rbind(data.frame(EVENT = "other", CropLoss = sum(other_df$CropLoss), PropertyLoss = sum(other_df$PropertyLoss)))
rm(other_df)
# Gather dataframe for the plot
econ_df <- econ_df %>%
gather(RESULT, NUMBERS, PropertyLoss, CropLoss)
## order by frequency, the most frequent bar coming first.
ggplot(econ_df, aes(x = reorder(EVENT, -NUMBERS),
y  = NUMBERS / 10^6,
fill = factor(RESULT),
color = factor(RESULT))) +
geom_bar(stat = "identity")+
labs(x = "Events",
y = "Monetary loss (million)") +
ggtitle("The events have the greatest economic consequences ") +
theme(
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black")) +
scale_color_brewer(palette="Set1")
rm(df2,df)
class(unique(toupper(df$EVTYPE))
)
df <- read.csv("repdata_data_StormData.csv.bz2", stringsAsFactors = FALSE, strip.white=TRUE, header=TRUE)
unique(toupper(df$EVTYPE))
class(unique(toupper(df$EVTYPE))
)
head(df, 100) %>%
kable(format = "html") %>%
kable_styling() %>%
kableExtra::scroll_box(width = "100%", height = "200px")
df$EVTYPE %>%
kable(format = "html") %>%
kableExtra::scroll_box(width = "100%", height = "200px")
